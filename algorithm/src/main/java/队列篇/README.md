### 队列

队列基于数组、链表实现，因此：数组和链表为物理结构描述，栈、队列为功能描述

队列也是一种操作受限的线性表结构

队列的应用也非常广泛，特别是一些具有某些额外特性的队列，比如循环队列、阻塞队列、并发队列。它们在很多偏底层系统、框架、中间件的开发中，起着关键性的作用。比如高性能队列 Disruptor、Linux 环形缓存，都用到了循环并发队列；Java concurrent 并发包利用 ArrayBlockingQueue 来实现公平锁等。

跟栈一样，队列可以用数组来实现，也可以用链表来实现。用数组实现的栈叫作顺序栈，用链表实现的栈叫作链式栈。同样，用数组实现的队列叫作顺序队列，用链表实现的队列叫作链式队列

#### 1.循环队列
判断队列为空：head==tail

判断队列为满：(tail+1)%n == head

当队列满时， tail 指向的位置实际上是没有存储数据的

#### 2.阻塞队列--生产者-消费者模型
在队列基础上增加了阻塞操作，就是在队列为空的时候，从队头取数据会被阻塞。因为此时还没有数据可取，直到队列中有了数据才能返回；如果队列已经满了，那么插入数据的操作就会被阻塞，直到队列中有空闲位置后再插入数据，然后再返回。

多线程情况下，会有多个线程同时操作队列，如何解决线程安全问题？

线程安全的队列我们叫作**并发队列**。最简单直接的实现方式是直接在 enqueue()、dequeue() 方法上加锁，但是锁粒度大并发度会比较低，同一时刻仅允许一个存或者取操作。实际上，基于数组的循环队列，利用 CAS 原子操作，可以实现非常高效的并发队列。这也是循环队列比链式队列应用更加广泛的原因。

**问题**：线程池没有空闲线程时，新的任务请求线程资源时，线程池该如何处理？各种处理策略又是如何实现的呢？

- 非阻塞的处理方式，直接拒绝任务请求
- 阻塞的处理方式，将请求排队，线程空闲时再取出进行处理

思考：如何实现无锁并发队列？

head和tail使用类型AtomicInteger 利用CAS原理实现无锁的原子性操作。

[知乎|一文搞懂CAS原理](https://zhuanlan.zhihu.com/p/94762520)

